#Automate Pentesting using Nuclei and Naabu.
#Author : Baibhav Anand Jha


#Ask for domain names seperated by space. Ex. facebook.com google.com github.com

read -p "Enter domain names separated by 'space' : " input

#Move to the directory containing Nudlei Templates to update it.

cd {directory containing nuclei templates folder.}
sudo rm -rf nuclei-templates
sudo git clone https://github.com/projectdiscovery/nuclei-templates

#Move to the directory where you want to save the results. For example : ReconOutput

cd {Directory to store files}
wait

#Loop to run scan for every domains.

for i in ${input[@]}
do
mkdir $i     
#Makes directory with name as domain name. For example a directory for github.com will be called github.com
cd $i

#Enemurates subdomains using amass and subfinder than filters the valid subdomains and removes the duplicate subdomains.

amass enum -d $i -o subdomain.txt
subfinder -d $i -silent | httpx -silent >> subdomain.txt
sort subdomain.txt | uniq | tee subdomains.txt
rm -rf subdomain.txt

#Run Nuclei scan for all the subdomains.

nuclei -silent -l subdomains.txt -t {Directory containing nuclei templates}/nuclei-templates/cves/ -o cves.txt
nuclei -silent -l subdomains.txt -t {Directory containing nuclei templates}/nuclei-templates/default-credentials/ -o default-credentials.txt
nuclei -silent -l subdomains.txt -t {Directory containing nuclei templates}/nuclei-templates/dns/ -o dns.txt
nuclei -silent -l subdomains.txt -t {Directory containing nuclei templates}/nuclei-templates/files/ -o files.txt
nuclei -silent -l subdomains.txt -t {Directory containing nuclei templates}/nuclei-templates/generic-detections/ -o generic-detections.txt
nuclei -silent -l subdomains.txt -t {Directory containing nuclei templates}/nuclei-templates/panels/ -o panels.txt
nuclei -silent -l subdomains.txt -t {Directory containing nuclei templates}/nuclei-templates/security-misconfiguration/ -o security-misconfigurations.txt
nuclei -silent -l subdomains.txt -t {Directory containing nuclei templates}/nuclei-templates/subdomain-takeover/ -o subdomain-takeover.txt
nuclei -silent -l subdomains.txt -t {Directory containing nuclei templates}/nuclei-templates/technologies/ -o technologies.txt
nuclei -silent -l subdomains.txt -t {Directory containing nuclei templates}/nuclei-templates/tokens/ -o tokens.txt
nuclei -silent -l subdomains.txt -t {Directory containing nuclei templates}/nuclei-templates/vulnerabilities/ -o vulnerabilities.txt
nuclei -silent -l subdomains.txt -t {Directory containing nuclei templates}/nuclei-templates/workflows/ -o workflows.txt

#Run Naabu Scan for all the subdomains.

naabu -ports top-1000 -iL subdomains.txt | bash {directory containing naabu2nmap.sh}/naabu2nmap.sh
cd {Directory to store files}

#OPTIONAL
#To upload the scan files to mega and delete from your machine.


#megacopy --local= "$i" --remote={Mega file store location} --config={Mega Conf directory}/mega.cnf
#rm -rf $i

done


